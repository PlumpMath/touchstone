<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>taoensso.touchstone documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html">Touchstone 2.0.0 API documentation</a></h1></div><div class="sidebar" id="namespaces"><h3><span>Namespaces</span></h3><ul><li class="current"><a href="taoensso.touchstone.html"><span>taoensso.touchstone</span></a></li><li><a href="taoensso.touchstone.ring.html"><span>taoensso.touchstone.ring</span></a></li><li><a href="taoensso.touchstone.utils.html"><span>taoensso.touchstone.utils</span></a></li></ul></div><div class="sidebar" id="vars"><h3>Public Vars</h3><ul><li><a href="taoensso.touchstone.html#var-*ts-id*"><span>*ts-id*</span></a></li><li><a href="taoensso.touchstone.html#var-ab-select"><span>ab-select</span></a></li><li><a href="taoensso.touchstone.html#var-commit%21"><span>commit!</span></a></li><li><a href="taoensso.touchstone.html#var-delete-test"><span>delete-test</span></a></li><li><a href="taoensso.touchstone.html#var-mab-select"><span>mab-select</span></a></li><li><a href="taoensso.touchstone.html#var-mab-select-id"><span>mab-select-id</span></a></li><li><a href="taoensso.touchstone.html#var-mab-select-ordered"><span>mab-select-ordered</span></a></li><li><a href="taoensso.touchstone.html#var-mab-select-permutations"><span>mab-select-permutations</span></a></li><li><a href="taoensso.touchstone.html#var-move-test"><span>move-test</span></a></li><li><a href="taoensso.touchstone.html#var-pr-results"><span>pr-results</span></a></li><li><a href="taoensso.touchstone.html#var-select-form%21"><span>select-form!</span></a></li><li><a href="taoensso.touchstone.html#var-selected-form-id"><span>selected-form-id</span></a></li><li><a href="taoensso.touchstone.html#var-with-test-subject"><span>with-test-subject</span></a></li></ul></div><div class="namespace-docs" id="content"><h2>taoensso.touchstone documentation</h2><pre class="doc">Simple, Carmine-backed Multi-Armed Bandit (MAB) split-testing. Both more
effective and more convenient than traditional A/B testing. Fire-and-forget!

Redis keys:
  * touchstone:&lt;test-id&gt;:nprospects -&gt; hash, {form-id count}
  * touchstone:&lt;test-id&gt;:scores     -&gt; hash, {form-id score}
  * touchstone:&lt;test-id&gt;:&lt;ts-id&gt;:selection  -&gt; ttl string, form-id
  * touchstone:&lt;test-id&gt;:&lt;ts-id&gt;:committed? -&gt; ttl flag

Ref. http://goo.gl/XPlP6 (UCB1 MAB algo)
     http://en.wikipedia.org/wiki/Multi-armed_bandit
     http://stevehanov.ca/blog/index.php?id=132</pre><div class="public" id="var-*ts-id*"><h3>*ts-id*</h3><div class="usage"></div><pre class="doc">Test subject id
</pre></div><div class="public" id="var-ab-select"><h3>ab-select</h3><h4 class="macro">macro</h4><div class="usage"><code>(ab-select config ts-id test-id &amp; id-form-pairs)</code></div><pre class="doc">Like `mab-select` but uses simple, A/B-style random selection. Unless you
know all the implications, you probably want `mab-select` instead.</pre></div><div class="public" id="var-commit%21"><h3>commit!</h3><div class="usage"><code>(commit! {:keys [conn ttl-ms non-uniques?], :or {ttl-ms (* 1000 60 60 2)}, :as config} ts-id test-id value)</code><code>(commit! config ts-id test-id value &amp; id-value-pairs)</code></div><pre class="doc">Signals the occurrence of one or more events, each of which may contribute
a specified value (-1 &lt;= value &lt;= 1) to a test score:

    ;; On sign-up button click:
    (commit! {} *ts-id* :my-app.landing.buttons/sign-up 1
                        :my-app.landing/title           0.5)

    ;; On buy button click:
    (commit! {} *ts-id* :my-app/sale-price (if (&gt;= order-item-qty 2) 1 0.8))

There's great flexibility in this to model all kinds of single or multivariate
test-&gt;event interactions. Any event can contribute to the score of any test,
positively or negatively, to any extent.

The statistics can get complicated so try keep things simple: resist the urge
to get fancy with the spices.</pre></div><div class="public" id="var-delete-test"><h3>delete-test</h3><div class="usage"><code>(delete-test {:keys [conn]} test-id)</code></div><pre class="doc"></pre></div><div class="public" id="var-mab-select"><h3>mab-select</h3><h4 class="macro">macro</h4><div class="usage"><code>(mab-select config ts-id test-id &amp; id-form-pairs)</code></div><pre class="doc">Defines a test that selects and evaluates one of the testing forms using the
&quot;UCB1&quot; selection algorithm:
   (mab-select {} *ts-id* :my-test-1
               :my-form-1 &quot;String 1&quot;
               :my-form-2 (do (Thread/sleep 2000) &quot;String 2&quot;))

 Dependent tests can be created through composition:
   (mab-select {} *ts-id* :my-test-1
               :my-form-1 &quot;String 1&quot;
               :my-form-2 (mab-select {} *ts-id* :my-test-1a ...))

 Test forms can be freely added, reordered, or removed for an ongoing test at
 any time, but avoid changing a particular form once id'd.</pre></div><div class="public" id="var-mab-select-id"><h3>mab-select-id</h3><h4 class="macro">macro</h4><div class="usage"><code>(mab-select-id config ts-id test-id &amp; ids)</code></div><pre class="doc">Like `mab-select` but takes only form ids and uses each id also as its form.
</pre></div><div class="public" id="var-mab-select-ordered"><h3>mab-select-ordered</h3><h4 class="macro">macro</h4><div class="usage"><code>(mab-select-ordered config ts-id test-id &amp; ordered-forms)</code></div><pre class="doc">Like `mab-select` but takes un-id'd forms and automatically ids them by their
order: :form-1, :form-2, ....</pre></div><div class="public" id="var-mab-select-permutations"><h3>mab-select-permutations</h3><h4 class="macro">macro</h4><div class="usage"><code>(mab-select-permutations config ts-id test-id take-n &amp; ordered-forms)</code></div><pre class="doc">Advanced. Defines a positional test with N!/(N-n)! testing forms. Each
testing form will be a vector permutation of the given `ordered-forms`,
automatically id'd for the order of its constituent forms.

Useful for testing the order of the first n forms out of N. The remaining
forms will retain their natural order.</pre></div><div class="public" id="var-move-test"><h3>move-test</h3><div class="usage"><code>(move-test {:keys [conn]} old-id new-id)</code></div><pre class="doc"></pre></div><div class="public" id="var-pr-results"><h3>pr-results</h3><div class="usage"><code>(pr-results {:keys [conn], :as config} test-id)</code><code>(pr-results config test-id &amp; more)</code></div><pre class="doc"></pre></div><div class="public" id="var-select-form%21"><h3>select-form!</h3><h4 class="macro">macro</h4><div class="usage"><code>(select-form! config strategy-fn ts-id test-id id-form-pairs)</code></div><pre class="doc">Implementation detail.
</pre></div><div class="public" id="var-selected-form-id"><h3>selected-form-id</h3><div class="usage"><code>(selected-form-id {:keys [conn]} ts-id test-id)</code></div><pre class="doc">Returns subject's currently selected form id for test, or nil. One common
idiom is to use this for creating dependent tests:
    (case (selected-form-id {} *ts-id* :my-test-1)
      :my-form-1 (mab-select {} *ts-id* :my-test-1a ...)
      :my-form-2 (mab-select {} *ts-id* :my-test-1b ...)
      nil)</pre></div><div class="public" id="var-with-test-subject"><h3>with-test-subject</h3><h4 class="macro">macro</h4><div class="usage"><code>(with-test-subject id &amp; body)</code></div><pre class="doc">Executes body within the context of thread-local test-subject-id binding.
</pre></div></div></body></html>